---
title: "將google表單的量尺資料轉為數字"
date: "2022-10-02"
tags:
- google表單
- 量尺轉換
- R
categories:
- 資料整理
---

<script src="/rmarkdown-libs/kePrint/kePrint.js"></script>
<link href="/rmarkdown-libs/lightable/lightable.css" rel="stylesheet" />


<p>Google表單的量尺刻度有時會有文字說明，在後續分析時需要先轉為數字。本文說明如何以R來做轉換，以利後續的資料處理。</p>
<!--more-->
<p>Google表單的量尺刻度有時會有文字說明，在後續分析時需要先轉為數字。本文說明如何以R來做轉換，以利後續的資料處理。</p>
<div id="資料範例" class="section level2">
<h2>資料範例</h2>
<p>請<a href="https://docs.google.com/spreadsheets/d/1Z9hGVdNaNmk41hbScOB1SUzTVZ_An41Z/edit?usp=sharing&amp;ouid=102534642616283273245&amp;rtpof=true&amp;sd=true">點選此處</a>下載google forms的資料範例。</p>
<p>資料為一虛擬的問卷資料，為25位大學生在五個問卷題目的回答。其中兩個題目是複選題，另有三個題目是四點量表的回答。</p>
</div>
<div id="讀入資料" class="section level2">
<h2>讀入資料</h2>
<p>以readxl套件的read_xlsx()函數讀入xlsx檔。</p>
<pre class="r"><code>library(readxl)
qData1 &lt;- read_xlsx(&#39;GoogleFormsData.xlsx&#39;)</code></pre>
<table class="table table-striped" style="font-size: 12.5px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
編號
</th>
<th style="text-align:center;">
你在高中時期擔任過哪些職務？
</th>
<th style="text-align:center;">
你對系所課程在學什麼的瞭解程度
</th>
<th style="text-align:center;">
你對科系專業證照如何取得的瞭解程度
</th>
<th style="text-align:center;">
你對畢業後的職涯選擇的瞭解程度
</th>
<th style="text-align:center;">
你希望除了專業知識之外還能精進哪些能力？
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
班級幹部, 社團幹部, 畢聯會幹部
</td>
<td style="text-align:center;">
3清楚
</td>
<td style="text-align:center;">
3清楚
</td>
<td style="text-align:center;">
4非常清楚
</td>
<td style="text-align:center;">
(2)外文能力, (11)程式與資訊能力
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
班級幹部, 社團幹部
</td>
<td style="text-align:center;">
3清楚
</td>
<td style="text-align:center;">
3清楚
</td>
<td style="text-align:center;">
3清楚
</td>
<td style="text-align:center;">
(2)外文能力, (3)表達與溝通能力, (4)獨立思考與問題解決能力
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
班級幹部, 社團幹部
</td>
<td style="text-align:center;">
2不清楚
</td>
<td style="text-align:center;">
3清楚
</td>
<td style="text-align:center;">
3清楚
</td>
<td style="text-align:center;">
(2)外文能力, (4)獨立思考與問題解決能力, (7)領導能力
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
班級幹部
</td>
<td style="text-align:center;">
3清楚
</td>
<td style="text-align:center;">
3清楚
</td>
<td style="text-align:center;">
4非常清楚
</td>
<td style="text-align:center;">
(3)表達與溝通能力, (4)獨立思考與問題解決能力, (5)創意與創新能力
</td>
</tr>
<tr>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
班級幹部, 社團幹部
</td>
<td style="text-align:center;">
3清楚
</td>
<td style="text-align:center;">
3清楚
</td>
<td style="text-align:center;">
3清楚
</td>
<td style="text-align:center;">
(2)外文能力, (3)表達與溝通能力, (10)社交能力
</td>
</tr>
<tr>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
班代表, 班級幹部, 社團幹部
</td>
<td style="text-align:center;">
3清楚
</td>
<td style="text-align:center;">
4非常清楚
</td>
<td style="text-align:center;">
2不清楚
</td>
<td style="text-align:center;">
(3)表達與溝通能力, (4)獨立思考與問題解決能力, (10)社交能力
</td>
</tr>
</tbody>
</table>
</div>
<div id="重新整理複選題資料-以單一題目單一回應為例" class="section level2">
<h2>重新整理複選題資料-以單一題目、單一回應為例</h2>
<p>以第三題「你對系所課程在學什麼的瞭解程度」為例，如果我們想要將「3清楚」的回答改為數字3，可以用下列程式碼來做。程式碼中的sapply(x, FUN, …)是將函數FUN套用在x上，x可以是向量或其他形式。此處的x為「qData1$你對系所課程在學什麼的瞭解程度」；FUN則為replace()函數，此replace()函數將x中屬於(%in%) val_replc(“3清楚”) 的元素原置換為 val_repl(數字3) 。</p>
<pre class="r"><code>val_replc &lt;- &quot;3清楚&quot;
val_repl &lt;- 3

qData1$你對系所課程在學什麼的瞭解程度 &lt;- sapply(qData1$你對系所課程在學什麼的瞭解程度,  
                                                function(x) replace(x, x %in% val_replc, val_repl))</code></pre>
<table class="table table-striped" style="font-size: 12.5px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
編號
</th>
<th style="text-align:center;">
你在高中時期擔任過哪些職務？
</th>
<th style="text-align:center;">
你對系所課程在學什麼的瞭解程度
</th>
<th style="text-align:center;">
你對科系專業證照如何取得的瞭解程度
</th>
<th style="text-align:center;">
你對畢業後的職涯選擇的瞭解程度
</th>
<th style="text-align:center;">
你希望除了專業知識之外還能精進哪些能力？
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
班級幹部, 社團幹部, 畢聯會幹部
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
3清楚
</td>
<td style="text-align:center;">
4非常清楚
</td>
<td style="text-align:center;">
(2)外文能力, (11)程式與資訊能力
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
班級幹部, 社團幹部
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
3清楚
</td>
<td style="text-align:center;">
3清楚
</td>
<td style="text-align:center;">
(2)外文能力, (3)表達與溝通能力, (4)獨立思考與問題解決能力
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
班級幹部, 社團幹部
</td>
<td style="text-align:center;">
2不清楚
</td>
<td style="text-align:center;">
3清楚
</td>
<td style="text-align:center;">
3清楚
</td>
<td style="text-align:center;">
(2)外文能力, (4)獨立思考與問題解決能力, (7)領導能力
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
班級幹部
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
3清楚
</td>
<td style="text-align:center;">
4非常清楚
</td>
<td style="text-align:center;">
(3)表達與溝通能力, (4)獨立思考與問題解決能力, (5)創意與創新能力
</td>
</tr>
<tr>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
班級幹部, 社團幹部
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
3清楚
</td>
<td style="text-align:center;">
3清楚
</td>
<td style="text-align:center;">
(2)外文能力, (3)表達與溝通能力, (10)社交能力
</td>
</tr>
<tr>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
班代表, 班級幹部, 社團幹部
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
4非常清楚
</td>
<td style="text-align:center;">
2不清楚
</td>
<td style="text-align:center;">
(3)表達與溝通能力, (4)獨立思考與問題解決能力, (10)社交能力
</td>
</tr>
</tbody>
</table>
</div>
<div id="以for迴圈一次處理所有回應" class="section level2">
<h2>以for迴圈一次處理所有回應</h2>
<p>以for迴圈對qData1的第3到5題，批次處理「1非常不清楚」到「4非常清楚」，依次替換為數字1到4。</p>
<pre class="r"><code>val_replc &lt;- c(&quot;1非常不清楚&quot;, &quot;2不清楚&quot;, &quot;3清楚&quot;, &quot;4非常清楚&quot;)
val_repl &lt;- c(1:4)
col_repl &lt;- c(3:5)

for (i in 1:length(val_repl)){
  qData1[col_repl] &lt;- sapply(qData1[col_repl],  
                             function(x) replace(x, x %in% val_replc[i], val_repl[i]))
}</code></pre>
<table class="table table-striped" style="font-size: 12.5px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
編號
</th>
<th style="text-align:center;">
你在高中時期擔任過哪些職務？
</th>
<th style="text-align:center;">
你對系所課程在學什麼的瞭解程度
</th>
<th style="text-align:center;">
你對科系專業證照如何取得的瞭解程度
</th>
<th style="text-align:center;">
你對畢業後的職涯選擇的瞭解程度
</th>
<th style="text-align:center;">
你希望除了專業知識之外還能精進哪些能力？
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
班級幹部, 社團幹部, 畢聯會幹部
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
(2)外文能力, (11)程式與資訊能力
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
班級幹部, 社團幹部
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
(2)外文能力, (3)表達與溝通能力, (4)獨立思考與問題解決能力
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
班級幹部, 社團幹部
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
(2)外文能力, (4)獨立思考與問題解決能力, (7)領導能力
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
班級幹部
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
(3)表達與溝通能力, (4)獨立思考與問題解決能力, (5)創意與創新能力
</td>
</tr>
<tr>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
班級幹部, 社團幹部
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
(2)外文能力, (3)表達與溝通能力, (10)社交能力
</td>
</tr>
<tr>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
班代表, 班級幹部, 社團幹部
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
(3)表達與溝通能力, (4)獨立思考與問題解決能力, (10)社交能力
</td>
</tr>
</tbody>
</table>
</div>
<div id="參考資料" class="section level2">
<h2>參考資料</h2>
<ol style="list-style-type: decimal">
<li><a href="https://statisticsglobe.com/replace-multiple-values-several-columns-data-frame-r">Replace Multiple Values in Several Columns of Data Frame in R (2 Examples)</a> <span class="citation">@Statistics</span> Globe</li>
<li><a href="https://kemushi54.github.io/R-basic/apply_family.html">取代迴圈的 apply 家族</a> by Kemushi54</li>
<li><a href="https://www.datasciencemadesimple.com/in-operator-in-r/">%IN% OPERATOR IN R</a> <span class="citation">@DataScience</span> Made Simple</li>
</ol>
</div>
